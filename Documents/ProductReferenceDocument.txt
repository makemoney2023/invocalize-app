# Product Reference Document

## Project Overview
This project is a Voice AI Call Data Management System designed to process and analyze call transcripts using AI, manage leads, and automate follow-up communications. It's built with modern web technologies and focuses on scalability, performance, and type safety.

## Tech Stack
- Framework: Next.js (App Router)
- Language: TypeScript
- Database: Supabase (Auth + Database)
- ORM: Drizzle ORM
- API: tRPC
- Validation: Zod
- HTTP Client: Axios
- AI Integration: OpenAI API
- Email Services: Resend, MailerSend
- Deployment: Vercel
- Styling: Tailwind CSS, Radix UI, shadcn/ui
- Authentication: Clerk

## Architecture Overview

### Data Flow
1. Lead Generation: Leads are captured and stored in the Supabase database.
2. Real-time Updates: The useLeadsData hook subscribes to changes in the leads table.
3. Transcript Analysis:
   - When a new lead with a concatenated_transcript is detected, the system triggers the analyzeTranscript function.
   - Uses OpenAI's GPT-3.5-turbo model to analyze the transcript.
   - Analysis results are validated with Zod schemas and stored in the call_analyses table.
4. Email Notification: Upon successful analysis, an email summary is sent to relevant parties.
5. CRM Integration: Lead data is synchronized with the CRM system.
6. Follow-up Management: Automated recommendations for follow-up timing and actions.

### Components Breakdown

#### Data Models
1. Lead Interface (src/types/lead.ts)
   - Defines the structure for lead information
   - Includes personal details, call metadata, analysis results

2. FollowUp Types (src/types/followup.ts)
   - Defines priority levels and recommendation structures
   - Includes effectiveness tracking metrics

3. Database Schema (src/db/schema.ts)
   - Structured using Drizzle ORM
   - Includes tables for leads, call analyses, and email logs

#### Services
1. CRM Service (src/services/crmService.ts)
   - Handles CRM contact creation and updates
   - Manages synchronization with external systems

2. Recommendation Service (src/services/recommendationService.ts)
   - Generates follow-up recommendations
   - Calculates priority and timing

3. Follow-up Effectiveness Service (src/services/followup-effectiveness-service.ts)
   - Tracks and analyzes follow-up success rates
   - Provides insights for improvement

#### Components
1. CRM Contacts Overview (src/components/crm-contacts-overview.tsx)
   - Displays contact information
   - Handles real-time updates
   - Implements infinite scrolling

2. UI Components (src/components/ui/)
   - Built with Radix UI primitives
   - Styled with Tailwind CSS
   - Includes Table, Dialog, Sheet components

### Key Features
1. Lead Management
   - Automated lead capture
   - Real-time updates
   - CRM integration

2. AI Analysis
   - Transcript processing
   - Sentiment analysis
   - Key point extraction

3. Follow-up System
   - Priority-based recommendations
   - Effectiveness tracking
   - Automated scheduling

4. Email Integration
   - Automated notifications
   - Email tracking
   - Template management

5. Real-time Updates
   - WebSocket connections
   - Instant data synchronization
   - Status notifications

### Areas for Improvement
1. Performance Optimization
   - Implement pagination for large datasets
   - Optimize real-time subscriptions
   - Add caching mechanisms

2. Security Enhancements
   - Implement role-based access control
   - Add API rate limiting
   - Enhance data encryption

3. Testing Coverage
   - Add unit tests for services
   - Implement E2E testing
   - Add integration tests

4. Documentation
   - Expand API documentation
   - Add component documentation
   - Include setup guides

### Future Enhancements
1. Advanced Analytics
   - Call pattern analysis
   - Success rate tracking
   - ROI calculations

2. Integration Expansion
   - Additional CRM platforms
   - Calendar systems
   - Communication tools

3. AI Capabilities
   - Multi-language support
   - Custom model training
   - Advanced sentiment analysis

4. Mobile Support
   - Responsive design
   - Mobile notifications
   - Offline capabilities
